<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organiza√ß√µes - JungAgent Admin</title>
    <link rel="stylesheet" href="/static/admin.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div>
                <h1>üè¢ Gest√£o de Organiza√ß√µes</h1>
                <p style="opacity: 0.9; margin-top: 5px;">Gerenciar todas as organiza√ß√µes do sistema</p>
            </div>
            <div class="header-info">
                <div class="user-name">{{ admin.full_name or admin.email }}</div>
                <span class="role-badge">üëë Master Admin</span>
            </div>
        </div>
    </div>

    <div class="nav">
        <div class="nav-content">
            <a href="/admin/master/dashboard">Dashboard</a>
            <a href="/admin/organizations" class="active">Organiza√ß√µes</a>
            <a href="/admin/admins">Administradores</a>
            <a href="/admin/users">Usu√°rios Jung</a>
            <form action="/admin/logout" method="POST" style="margin-left: auto;">
                <button type="submit" class="logout-btn nav">Sair</button>
            </form>
        </div>
    </div>

    <div class="container">
        <!-- Success Message -->
        {% if request.query_params.get('success') %}
        <div class="alert alert-success">
            ‚úÖ {{ request.query_params.get('success') }}
        </div>
        {% endif %}

        <!-- Actions -->
        <div class="section">
            <div class="section-header">
                <h2>üìä Todas as Organiza√ß√µes</h2>
                <a href="/admin/organizations/new" class="btn btn-primary" style="pointer-events: auto !important; cursor: pointer !important;">+ Nova Organiza√ß√£o</a>
            </div>

            {% if organizations %}
            <table>
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Slug</th>
                        <th>Ind√∫stria</th>
                        <th>Tamanho</th>
                        <th>Plano</th>
                        <th>Status</th>
                        <th>Usu√°rios</th>
                        <th>Admins</th>
                        <th>Link de Convite</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for org in organizations %}
                    <tr>
                        <td><strong>{{ org.org_name }}</strong></td>
                        <td><code>{{ org.org_slug }}</code></td>
                        <td>{{ org.industry or '‚Äî' }}</td>
                        <td>
                            <span class="badge badge-{{ org.size or 'default' }}">
                                {{ org.size.upper() if org.size else '‚Äî' }}
                            </span>
                        </td>
                        <td>
                            <span class="badge badge-{{ org.subscription_tier }}">
                                {{ org.subscription_tier.upper() }}
                            </span>
                        </td>
                        <td>
                            <span class="badge badge-{{ org.subscription_status }}">
                                {{ org.subscription_status.upper() }}
                            </span>
                        </td>
                        <td>{{ org.user_count }}</td>
                        <td>{{ org.admin_count }}</td>
                        <td>
                            <code style="font-size: 0.85em; background: #f5f5f5; padding: 4px 8px; border-radius: 4px; cursor: pointer;"
                                  onclick="navigator.clipboard.writeText('https://t.me/YOUR_BOT_USERNAME?start=org_{{ org.org_slug }}'); alert('Link copiado!');"
                                  title="Clique para copiar">
                                üîó t.me/bot?start=org_{{ org.org_slug }}
                            </code>
                        </td>
                        <td class="actions">
                            <a href="/admin/organizations/{{ org.org_id }}/edit" class="btn-action btn-edit" title="Editar">
                                ‚úèÔ∏è
                            </a>
                            {% if org.org_id != 'default-org' %}
                            <form method="POST" action="/admin/organizations/{{ org.org_id }}/delete" style="display: inline;"
                                  onsubmit="return confirm('Tem certeza que deseja desativar a organiza√ß√£o {{ org.org_name }}?');">
                                <button type="submit" class="btn-action btn-delete" title="Desativar">
                                    üóëÔ∏è
                                </button>
                            </form>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="empty-state">
                <p>Nenhuma organiza√ß√£o encontrada</p>
                <a href="/admin/organizations/new" class="btn btn-primary" style="margin-top: 20px;">+ Criar Primeira Organiza√ß√£o</a>
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>
